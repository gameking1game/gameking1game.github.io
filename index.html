<script>
    const users = [
        { username: "Yönetici", password: "Yönetici1", passwordChanges: 0, isAdmin: true },
        { username: "Yönetici2", password: "A1", passwordChanges: 0, isAdmin: true },
        { username: "GAMEKINGPOYRAZ", password: "ADMIN1", passwordChanges: 0, isAdmin: true, transactionNumber: "ADMINGAMEKİNGPOYRAZ" },
        { username: "Kullanıcı", password: "user123", passwordChanges: 0, isAdmin: false }
    ];

    let currentUser = null;
    let announcements = [];
    let inbox = [];

    function login() {
        const username = document.getElementById('loginUsername').value;
        const password = document.getElementById('loginPassword').value;

        currentUser = users.find(user => user.username === username && user.password === password);

        if (currentUser) {
            const transactionNumber = prompt("İşlem numaranızı yazın:");
            if (currentUser.isAdmin && transactionNumber === currentUser.transactionNumber) {
                showUserInterface();
            } else if (!currentUser.isAdmin) {
                showUserInterface();
            } else {
                alert("Geçersiz işlem numarası.");
                logout();
            }
        } else {
            alert("Geçersiz kullanıcı adı veya şifre.");
        }
    }

    function logout() {
        currentUser = null;
        document.getElementById('loginSection').style.display = 'block';
        document.getElementById('infoSection').style.display = 'none';
    }

    function showRegisterAlert() {
        alert('GAME KİNG POYRAZ DESTEK\'TEN ŞİFRE ALIN');
    }

    function changePassword() {
        if (currentUser.passwordChanges >= 2) {
            alert("Maksimum şifre değiştirme hakkınızı doldurdunuz.");
            return;
        }

        const newPassword = prompt("Yeni şifrenizi girin:");
        if (newPassword) {
            currentUser.password = newPassword;
            currentUser.passwordChanges += 1;
            alert("Şifreniz başarıyla değiştirildi.");
        } else {
            alert("Şifre değiştirilemedi.");
        }
    }

    function createAccount() {
        if (currentUser.isAdmin) {
            const newUsername = prompt("Yeni kullanıcı adı girin:");
            const newPassword = prompt("Yeni şifre girin:");
            const transactionNumber = prompt("Yeni işlem numarası girin:");

            if (newUsername && newPassword && transactionNumber) {
                if (users.find(u => u.username === newUsername)) {
                    alert("Bu kullanıcı adı zaten mevcut.");
                } else {
                    users.push({ username: newUsername, password: newPassword, transactionNumber: transactionNumber, passwordChanges: 0, isAdmin: false });
                    alert("Yeni hesap başarıyla oluşturuldu!");
                }
            } else {
                alert("Kullanıcı adı, şifre ve işlem numarası boş olamaz.");
            }
        } else {
            alert("Sadece Yönetici bu butonu kullanabilir.");
        }
    }

    function sendAnnouncement() {
        const message = prompt("Göndermek istediğiniz duyuruyu yazın:");
        if (message) {
            announcements.push(message);
            alert("Duyuru başarıyla gönderildi!");
        }
    }

    function viewInbox() {
        if (inbox.length === 0) {
            alert("Henüz gelen mesajınız yok.");
        } else {
            alert("Gelen Mesajlar:\n" + inbox.join("\n"));
        }
    }

    function sendMessage() {
        const accountName = prompt("HESAP ADI:");
        const accountLevel = prompt("HESAP SEVİYESİ:");
        const accountStatus = prompt("HESABA ŞUAN NE YAPILIYOR:");

        const recipient = users.find(u => u.username === accountName);
        if (recipient) {
            inbox.push(`HESAP ADI: ${accountName}\nHESAP SEVİYESİ: ${accountLevel}\nHESABA ŞUAN NE YAPILIYOR: ${accountStatus}`);
            alert("Mesaj başarıyla gönderildi!");
            // Make the inbox button blink for the specific user
            document.getElementById('inboxButton').classList.add('yellow-blink');
        } else {
            alert("Kullanıcı bulunamadı.");
        }
    }

    document.getElementById('forgotPasswordButton').addEventListener('click', function() {
        const username = prompt("Kullanıcı adınızı girin:");
        const user = users.find(u => u.username === username);

        if (user) {
            const email = prompt("E-posta adresinizi girin (örn: user@gmail.com):");

            if (email.endsWith("@gmail.com") || email.endsWith("@outlook.com")) {
                const newGeneratedPassword = Math.random().toString(36).slice(-8);
                user.password = newGeneratedPassword;
                alert("Yeni şifreniz e-posta adresinize gönderildi: " + newGeneratedPassword);
            } else {
                alert("Geçersiz e-posta adresi.");
            }
        } else {
            alert("Kullanıcı bulunamadı.");
        }
    });

    function showUserInterface() {
        document.getElementById('loginSection').style.display = 'none';
        document.getElementById('infoSection').style.display = 'block';
        document.getElementById('userName').innerText = currentUser.username;

        if (currentUser.isAdmin) {
            document.getElementById('accountActionButton').style.display = 'block';
            document.getElementById('announcementButton').style.display = 'block';
            document.getElementById('messageButton').style.display = 'block';
        }
    }
</script>
